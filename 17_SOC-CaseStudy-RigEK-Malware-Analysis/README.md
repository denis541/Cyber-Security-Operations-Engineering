# Incident Case Study: Drive-by Malware Infection via Exploit Kit (EK)
![Case](https://img.shields.io/badge/Case-Drive--by%20Malware-blue)
![Attack](https://img.shields.io/badge/Attack-Exploit%20Kit-red)
![Detection](https://img.shields.io/badge/Detection-Snort%20%7C%20Suricata-yellow)
![Tools](https://img.shields.io/badge/Tools-Kibana%20%7C%20CapME%20%7C%20Zeek-green)
![Analysis](https://img.shields.io/badge/Analysis-GEO--IP%20%7C%20Domain-orange)

## Executive Summary
This report documents a sophisticated **multi-stage malware infection** identified via **Snort NIDS**.  
The attack utilized a **Drive-by Download** technique, where a legitimate website was compromised to host a malicious **iFrame**.  
This iFrame redirected the victim's browser to an **Exploit Kit (EK)** landing page, ultimately resulting in host compromise.

---

## Technical Analysis of the Attack Chain

### Phase 1: The Referral (Drive-by Entry)
- **Tools Used**: Kibana, CapME!  
- **Initial Intent**: User navigated to a legitimate site (**Referer URL**).  
- **Malicious Redirection**: The site's HTML contained an invisible iFrame pointing to a secondary malicious URL (`tybenme.com`).  
- **Analyst Note**: Demonstrates a classic **Referer-Header manipulation** used in drive-by campaigns to obscure the source of malicious traffic.  

---

### Phase 2: Exploit Kit Activity (NIDS Detection)
- **Detection Source**: Snort/Suricata engine within **Security Onion**.  
- **Severity**: Multiple **High Severity alerts** triggered.  
- **Malware Family**: *[Identify family, e.g., RigEK or GandCrab]*  
- **Detection Signature**: Emerging Threats Snort Alert rule for Exploit Kits.  
- **Technical Payload**: Transcript revealed delivery of:  
  - Obfuscated **JavaScript**  
  - Malicious MIME types (e.g., `application/x-shockwave-flash`, `application/x-msdownload`)  

---

### Phase 3: Traffic Correlation (Sguil & Zeek)
- **Tools Used**: Sguil, Zeek (Bro), Kibana  
- **Correlation**: 5-tuple data mapped to full HTTP request chain.  
- **GEO-IP Analysis**: Destination IP traced to *[Insert Country]*, inconsistent with typical traffic patterns.  
- **Domain Analysis**: Malicious domains leveraged **Shadowed Domains** or **recently registered domains** to evade reputation-based filters.  

---

## Analyst Recommendations & Mitigation

### Web Content Filtering
- Implement an **Egress Proxy** with strict category blocking for:  
  - **Newly Registered Domains (NRDs)**  
  - Known EK landing sites  

### Browser Hardening
- Disable or restrict outdated plugins (**Flash, Silverlight**)  
- Enforce enterprise-wide use of **Ad-blockers/Script-blockers** to prevent iFrame execution  

### Vulnerability Management
- Ensure all endpoint browsers and applications are **patched**  
- Exploit Kits rely heavily on **unpatched client-side vulnerabilities**  

---
