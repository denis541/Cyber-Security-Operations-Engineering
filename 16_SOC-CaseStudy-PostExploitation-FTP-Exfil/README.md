# Incident Response Case Study: Post-Exploitation & FTP Data Exfiltration
![Status](https://img.shields.io/badge/Case-Post--Exploitation-blue)
![Security](https://img.shields.io/badge/Focus-Data%20Exfiltration-red)
![Protocol](https://img.shields.io/badge/Protocol-FTP-orange)
![Tools](https://img.shields.io/badge/Tools-Wireshark%20%7C%20Zeek%20%7C%20Kibana-green)
![Detection](https://img.shields.io/badge/Detection-Snort%20%7C%20Sguil-yellow)
![Remediation](https://img.shields.io/badge/Remediation-SFTP%20%7C%20EDR-success)

## Executive Summary
This investigation covers the detection and analysis of a compromised Linux host.  
The adversary successfully gained **root access** and utilized **File Transfer Protocol (FTP)** to exfiltrate sensitive data (`confidential.txt`) before deleting the local copy.  
This report outlines the identification of the **5-tuple indicators** and the subsequent reconstruction of the data theft.

---

## Incident Lifecycle

### 1. Alert Triage (Sguil)
- **Detection Trigger**: Snort rule `GPL ATTACK_RESPONSE id check returned root`.  
- **Significance**: Indicates a high-severity compromise where a **remote command execution (RCE)** resulted in root privileges.  
- **Pivot**: Transcript analysis for **Alert ID 5.1** confirmed the threat actor executed `whoami` and `ls` commands on the target system.  

---

### 2. Deep Packet Inspection (Wireshark)
- **Pivot**: From alert to raw traffic for **TCP Stream Reconstruction**.  
- **Observation**: Red/blue color-coded transcript revealed a **clear-text session** where the attacker accessed the filesystem.  
- **Extracted IOCs**:  
  - Threat actor IP: `209.165.201.17`  
  - Targeted file: `confidential.txt`  

---

### 3. Log Correlation & File Analysis (Zeek/Kibana)
- **Service Identification**: Filtering for `bro_ftp` and `FTP_DATA` confirmed attacker moved the file off-network.  
- **Credential Harvesting**: Clear-text FTP credentials recovered from logs.  
- **MIME Type Tracking**: Zeek "Files" hunting isolated the `text/plain` file transfer event, enabling full recovery of stolen information.  

---

## Remediation & Hardening

### Protocol Disabling
- **Issue**: FTP transmits credentials in clear-text.  
- **Recommendation**: Migrate to **SFTP (SSH File Transfer Protocol)**.  

### Egress Filtering
- Implement strict **outbound firewall rules** to prevent internal hosts from initiating FTP connections to unknown external IPs.  

### Host-Based Monitoring
- Deploy an **EDR solution** to alert on suspicious parent-child process relationships.  
  - Example: A web server process spawning `whoami` or `ftp` commands.  

---
